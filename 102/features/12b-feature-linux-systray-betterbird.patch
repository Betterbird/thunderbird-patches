# HG changeset patch
# User Betterbird <betterbird@betterbird.eu>
# Parent  74b6a3af6b96bd9471a0dd2255cd5901e2f86781
Feature: Linux systray.

diff --git a/mailnews/base/src/MailNotificationManager.jsm b/mailnews/base/src/MailNotificationManager.jsm
--- a/mailnews/base/src/MailNotificationManager.jsm
+++ b/mailnews/base/src/MailNotificationManager.jsm
@@ -61,21 +61,23 @@ class MailNotificationManager {
       .getService(Ci.mozINewMailNotificationService)
       .addListener(this, Ci.mozINewMailNotificationService.count);
     Services.obs.addObserver(this, "unread-im-count-changed");
     Services.obs.addObserver(this, "profile-before-change");
 
     if (AppConstants.platform == "macosx") {
       Services.obs.addObserver(this, "new-directed-incoming-message");
     }
-    if (AppConstants.platform == "win") {
+    if (AppConstants.platform == "win" || AppConstants.platform == "linux") {
       Services.obs.addObserver(this, "profile-after-change");
-      Services.obs.addObserver(this, "windows-refresh-badge-tray");
-      Services.prefs.addObserver("mail.biff.show_badge", this);
       Services.prefs.addObserver("mail.biff.show_tray_icon_always", this);
+      if (AppConstants.platform == "win") {
+        Services.obs.addObserver(this, "windows-refresh-badge-tray");
+        Services.prefs.addObserver("mail.biff.show_badge", this);
+      }
     }
 
     XPCOMUtils.defineLazyGetter(this, "_osIntegration", () => {
       try {
         let osIntegration = Cc[
           "@mozilla.org/messenger/osintegration;1"
         ].getService(Ci.nsIMessengerOSIntegration);
         if (AppConstants.platform == "win") {
