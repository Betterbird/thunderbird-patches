# HG changeset patch
# User Betterbird <betterbird@betterbird.eu>
# Date 1674987411 -3600
# Parent  4cb115f4381c9ac845d71296e6a9527f5d0a2a26
Bug 1813346 - Fix tree refresh when using Subscribe/Unsubscribe buttons.

diff --git a/mailnews/base/content/subscribe.js b/mailnews/base/content/subscribe.js
--- a/mailnews/base/content/subscribe.js
+++ b/mailnews/base/content/subscribe.js
@@ -338,16 +338,20 @@ function SetSubscribeState(state) {
           SetState(name, state, k);
         }
       }
     }
 
     if (inSearchMode) {
       // Force a repaint.
       InvalidateSearchTree();
+    } else {
+      // Strangely `view.tree.invalidate()` doesn't refresh the tree,
+      // but focusing it does.
+      gSubscribeTree.focus();
     }
   } catch (ex) {
     dump("SetSubscribedState failed:  " + ex + "\n");
   }
 }
 
 function ReverseStateFromNode(row) {
   let name = gSubscribeTree.view.getCellValue(
