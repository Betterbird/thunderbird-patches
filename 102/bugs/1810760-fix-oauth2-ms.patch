# HG changeset patch
# User Sean Burke <sean@thunderbird.net>
# Date 1674125721 -3600
# Node ID c3df7b850679b8fe05edf1a5bfe8eb5e72f1e313
# Parent  16152e74fb56a72a81055210299b791c4cb67776
Bug 1810760 - don't use CORS with client requests.

diff --git a/mailnews/base/src/OAuth2.jsm b/mailnews/base/src/OAuth2.jsm
--- a/mailnews/base/src/OAuth2.jsm
+++ b/mailnews/base/src/OAuth2.jsm
@@ -253,16 +253,17 @@ OAuth2.prototype = {
       data.append("code", aCode);
       data.append("redirect_uri", this.redirectionEndpoint);
     }
 
     fetch(this.tokenEndpoint, {
       method: "POST",
       cache: "no-cache",
       body: data,
+      mode: "no-cors",
     })
       .then(response => response.json())
       .then(result => {
         let resultStr = JSON.stringify(result, null, 2);
         if ("error" in result) {
           // RFC 6749 section 5.2. Error Response
           this.log.info(
             `The authorization server returned an error response: ${resultStr}`
