# HG changeset patch
# User welpy-cw <h.w.forms@arcor.de>
# Date 1768330653 -3600
# Parent  72624ee996ea0679ca32782950b904636b5bbb34
Bug 2009930 - Fix MailGoButton context menu for when no message is displayed.

diff --git a/mail/components/unifiedtoolbar/content/items/mail-go-button.mjs b/mail/components/unifiedtoolbar/content/items/mail-go-button.mjs
--- a/mail/components/unifiedtoolbar/content/items/mail-go-button.mjs
+++ b/mail/components/unifiedtoolbar/content/items/mail-go-button.mjs
@@ -58,9 +58,10 @@ class MailGoButton extends MailTabButton
     event.stopPropagation();
 
     const tabmail = document.getElementById("tabmail");
     const currentWindow = tabmail.currentTabInfo.chromeBrowser.contentWindow;
-    const { messageHistory } = tabmail.currentAboutMessage;
+    const { messageHistory } =
+      tabmail.currentAboutMessage ?? currentWindow.messageBrowser.contentWindow;
     const { entries, currentIndex } = messageHistory.getHistory();
 
     // For populating the back menu, we want the most recently visited
     // messages first in the menu. So we go backward from curPos to 0.
@@ -147,9 +148,10 @@ class MailGoButton extends MailTabButton
     const nsMsgViewIndex_None = 0xffffffff;
     const historyIndex = Number.parseInt(target.getAttribute("value"), 10);
     const tabmail = document.getElementById("tabmail");
     const currentWindow = tabmail.currentTabInfo.chromeBrowser.contentWindow;
-    const messageHistory = tabmail.currentAboutMessage.messageHistory;
+    const { messageHistory } =
+      tabmail.currentAboutMessage ?? currentWindow.messageBrowser.contentWindow;
     if (!messageHistory || !messageHistory.canPop(historyIndex)) {
       return;
     }
     const item = messageHistory.pop(historyIndex);
