# HG changeset patch
# User Betterbird <betterbird@betterbird.eu>
# Parent  16616195338ee1d7aed79e7475fe4f953bd195ee
Bug 2018473 - Fix accumulation of ENVID for DNS-aware servers when sending from Outbox.

diff --git a/mailnews/compose/src/nsMsgSendLater.cpp b/mailnews/compose/src/nsMsgSendLater.cpp
--- a/mailnews/compose/src/nsMsgSendLater.cpp
+++ b/mailnews/compose/src/nsMsgSendLater.cpp
@@ -88,8 +88,9 @@ nsMsgSendLater::nsMsgSendLater() {
 nsMsgSendLater::~nsMsgSendLater() {
   PR_Free(m_to);
   PR_Free(m_fcc);
   PR_Free(m_bcc);
+  PR_Free(m_messageId);
   PR_Free(m_newsgroups);
   PR_Free(m_headers);
   PR_Free(mLeftoverBuffer);
   PR_Free(mIdentityKey);
@@ -909,10 +910,11 @@ nsresult nsMsgSendLater::BuildHeaders() 
   char* buf_end = buf + m_headersFP;
 
   PR_FREEIF(m_to);
   PR_FREEIF(m_bcc);
+  PR_FREEIF(m_fcc);
+  PR_FREEIF(m_messageId);
   PR_FREEIF(m_newsgroups);
-  PR_FREEIF(m_fcc);
   PR_FREEIF(mIdentityKey);
   PR_FREEIF(mAccountKey);
   m_flags = 0;
 
