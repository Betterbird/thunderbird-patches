# HG changeset patch
# User welpy-cw <h.w.forms@arcor.de>
# Date 1766329921 -3600
# Node ID 03db4c8656efc298c3b24d846aa3f301d4fd973a
# Parent  3e9bf2f6addf4688f247b52e2535d352bef64bfc
Bug 1829748 - Sort "Recent destinations" submenu by time of modification. r=tobyp

Differential Revision: https://phabricator.services.mozilla.com/D268510

diff --git a/mailnews/base/content/folder-menupopup.js b/mailnews/base/content/folder-menupopup.js
--- a/mailnews/base/content/folder-menupopup.js
+++ b/mailnews/base/content/folder-menupopup.js
@@ -550,9 +550,9 @@
         }
 
         switch (specialType) {
           case "recent":
-            // Find the most recently modified ones.
+            // Find the folders that were most recently used as destinations.
             specialFolders = lazy.FolderUtils.getMostRecentFolders(
               specialFolders,
               Services.prefs.getIntPref("mail.folder_widget.max_recent"),
               "MRMTime"
@@ -609,14 +609,16 @@
                 : "")
             : folderItem.folderName;
         }
 
-        // Make sure the entries are sorted alphabetically.
-        specialFoldersMap.sort((a, b) =>
-          lazy.FolderUtils.folderNameCompare(a.label, b.label)
-        );
+        // If appropriate, sort the entries alphabetically.
+        if (specialType != "recent") {
+          specialFoldersMap.sort((a, b) =>
+            lazy.FolderUtils.folderNameCompare(a.label, b.label)
+          );
+        }
 
-        // Create entries for each of the recent folders.
+        // Create entries for each of the special folders.
         for (const folderItem of specialFoldersMap) {
           const attributes = {
             label: folderItem.label,
             tooltiptext: `${folderItem.folderPath} - ${folderItem.serverName}`,
