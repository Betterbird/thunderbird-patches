# HG changeset patch
# User Betterbird <betterbird@betterbird.eu>
# Date 1769127742 -3600
# Parent  fbed93bf30c0b79b3b0c0984a3002fbcfbba8d0d
Bug 2008314 - Fix via backout of bug 1990129 and adjust message editor accordingly.

diff --git a/mail/modules/MessageEditor.sys.mjs b/mail/modules/MessageEditor.sys.mjs
--- a/mail/modules/MessageEditor.sys.mjs
+++ b/mail/modules/MessageEditor.sys.mjs
@@ -1138,8 +1138,11 @@ export class MessageEditor {
           `copyServiceListener.onStopCopy - ` +
             (args.isIMAP ? "IMAP, " : "") +
             `status ${status}`
         );
+        if (args.isIMAP) {
+          args.folder.updateFolder(args.msgWindow);
+        }
         success(this.newMsgKey);
       },
       QueryInterface: ChromeUtils.generateQI([
         Ci.nsISupports,
diff --git a/mailnews/imap/src/nsImapMailFolder.cpp b/mailnews/imap/src/nsImapMailFolder.cpp
--- a/mailnews/imap/src/nsImapMailFolder.cpp
+++ b/mailnews/imap/src/nsImapMailFolder.cpp
@@ -5167,9 +5167,11 @@ nsImapMailFolder::OnStopRunningUrl(nsIUR
                     txnMgr->DoTransaction(txn);
                   }
                 }
                 (void)OnCopyCompleted(m_copyState->m_srcSupport, aExitCode);
-                UpdateFolderWithListener(msgWindow, m_urlListener);
+                if (imapAction == nsIImapUrl::nsImapAppendDraftFromFile) {
+                  UpdateFolderWithListener(msgWindow, m_urlListener);
+                }
               }
             } else {
               // clear the copyState if copy has failed
               (void)OnCopyCompleted(m_copyState->m_srcSupport, aExitCode);
