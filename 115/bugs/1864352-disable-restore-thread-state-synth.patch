# HG changeset patch
# User welpy-cw <h.w.forms@arcor.de>
# Date 1699895833 -3600
# Parent  4284ee236b5eb726baed15517596c59acb8183cf
Bug 1864352 - Disable restoreThreadState() for synthetic views. r=mkmelin

diff --git a/mail/base/content/about3Pane.js b/mail/base/content/about3Pane.js
--- a/mail/base/content/about3Pane.js
+++ b/mail/base/content/about3Pane.js
@@ -5455,16 +5455,21 @@ var threadPane = {
       window.threadPane.restoreSelection();
     }
   },
 
   /**
    * Restore the collapsed or expanded state of threads.
    */
   restoreThreadState() {
+    // Expanding all threads in synthetic views doesn't work properly for
+    // backend reasons.
+    if (gViewWrapper.isSynthetic) {
+      return;
+    }
     if (
       gViewWrapper._threadExpandAll &&
       !(gViewWrapper.dbView.viewFlags & Ci.nsMsgViewFlagsType.kExpandAll)
     ) {
       gViewWrapper.dbView.doCommand(Ci.nsMsgViewCommandType.expandAll);
     }
     if (
       !gViewWrapper._threadExpandAll &&
