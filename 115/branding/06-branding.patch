# HG changeset patch
# User Betterbird <betterbird@betterbird.eu>
# Date 1682897813 -7200
# Parent  b1731bcc81ea8eedb753ca54442e14bba75ca685
Branding 6: Clean up About box, switch off the updater, fix donation links.
* * *
Misc: Add ! to helpus.end, to see get 'Make a donation!'

diff --git a/mail/base/content/aboutDialog.xhtml b/mail/base/content/aboutDialog.xhtml
--- a/mail/base/content/aboutDialog.xhtml
+++ b/mail/base/content/aboutDialog.xhtml
@@ -27,19 +27,19 @@
     <xul:key keycode="VK_ESCAPE" oncommand="window.close();"/>
 #ifdef XP_MACOSX
     <xul:key id="key_close" modifiers="accel" data-l10n-id="cmd-close-mac-command-key"
          oncommand="window.close();"/>
 #endif
   </xul:keyset>
   <div id="aboutDialogContainer">
     <xul:hbox id="clientBox">
-      <xul:vbox id="leftBox" flex="1"/>
-      <xul:vbox id="rightBox">
-        <xul:hbox align="baseline">
+      <xul:vbox id="leftBox" flex="0"/>
+      <xul:vbox id="rightBox" flex="1">
+        <xul:hbox align="baseline" style="margin-top: 10px;">
           <span id="version"></span>
           <a id="releasenotes" class="text-link browser-link" hidden="hidden"
              data-l10n-id="release-notes-link"></a>
         </xul:hbox>
 
         <span id="distribution" class="text-blurb"></span>
         <span id="distributionId" class="text-blurb"></span>
 
@@ -137,47 +137,27 @@
 
 #ifdef MOZ_UPDATER
           <div class="text-blurb" id="currentChannelText" data-l10n-id="channel-description"
                data-l10n-args='{"channel": ""}'
                data-l10n-attrs="{&quot;channel&quot;: &quot;&quot;}">
             <span id="currentChannel" data-l10n-name="current-channel"></span>
           </div>
 #endif
+          <!-- experimental is switched off via JS for release builds -->
           <xul:vbox id="experimental" hidden="true">
-            <div class="text-blurb" id="warningDesc">
-              <span data-l10n-id="warning-desc-version"></span>
-#ifdef MOZ_TELEMETRY_ON_BY_DEFAULT
-              <span data-l10n-id="warning-desc-telemetry"></span>
-#endif
-            </div>
-            <div class="text-blurb" id="communityExperimentalDesc" data-l10n-id="community-experimental">
-              <a class="text-link browser-link" href="https://www.mozilla.org/"
-                 data-l10n-name="community-exp-mozilla-link"></a>
-              <a class="text-link tab-link" href="about:credits"
-                 data-l10n-name="community-exp-credits-link"></a>
-            </div>
           </xul:vbox>
+          <div class="text-blurb" style="margin-bottom: 0; font-size: 2em;">
+            <a class="text-link browser-link" href="https://www.betterbird.eu/">www.betterbird.eu</a>
+          </div>
+          <!-- communityDesc is switched off via JS for Daily builds -->
           <div class="text-blurb" id="communityDesc" data-l10n-id="community-desc">
-            <a class="text-link browser-link" href="https://www.mozilla.org/" data-l10n-name="community-mozilla-link"></a>
-            <a class="text-link tab-link" href="about:credits" data-l10n-name="community-credits-link"></a>
           </div>
           <div class="text-blurb" id="contributeDesc" data-l10n-id="about-donation">
-            <a class="text-link browser-link" href="https://give.thunderbird.net/?utm_source=thunderbird-client&amp;utm_medium=referral&amp;utm_content=about-dialog"
+            <a class="text-link browser-link" href="https://www.betterbird.eu/donate/"
                data-l10n-name="helpus-donate-link"></a>
-            <a class="text-link browser-link" href="https://www.thunderbird.net/get-involved/"
-               data-l10n-name="helpus-get-involved-link"></a>
           </div>
         </xul:vbox>
       </xul:vbox>
     </xul:hbox>
-    <xul:vbox id="bottomBox">
-      <xul:hbox pack="center">
-        <a class="text-link bottom-link tab-link" href="about:license" data-l10n-id="bottom-links-license"></a>
-        <a class="text-link bottom-link tab-link" href="about:rights" data-l10n-id="bottom-links-rights"></a>
-        <a class="text-link bottom-link browser-link" href="https://www.mozilla.org/privacy/thunderbird/"
-           data-l10n-id="bottom-links-privacy"></a>
-      </xul:hbox>
-      <span id="trademark" data-l10n-id="trademarkInfo"></span>
-    </xul:vbox>
   </div>
 </body>
 </html>
diff --git a/mail/base/content/helpMenu.inc.xhtml b/mail/base/content/helpMenu.inc.xhtml
--- a/mail/base/content/helpMenu.inc.xhtml
+++ b/mail/base/content/helpMenu.inc.xhtml
@@ -1,36 +1,22 @@
 # This Source Code Form is subject to the terms of the Mozilla Public
 # License, v. 2.0. If a copy of the MPL was not distributed with this
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 <menu id="helpMenu"
       data-l10n-id="menu-help-help-title"
       onpopupshowing="buildHelpMenu();">
         <menupopup id="menu_HelpPopup">
-          <menuitem id="menu_openHelp"
-                    data-l10n-id="menu-help-get-help"
-                    key="key_openHelp"
-                    oncommand="openSupportURL();"/>
-          <menuitem id="menu_openTour"
-                    data-l10n-id="menu-help-explore-features"
-                    oncommand="openLinkText(event, 'tourURL');"/>
           <menuitem id="menu_keyboardShortcuts"
                     data-l10n-id="menu-help-shortcuts"
                     oncommand="openLinkText(event, 'keyboardShortcutsURL');"/>
-          <menuseparator/>
-          <menuitem id="getInvolved"
-                    data-l10n-id="menu-help-get-involved"
-                    oncommand="openLinkText(event, 'getInvolvedURL');"/>
           <menuitem id="donationsPage"
                     data-l10n-id="menu-help-donation"
                     oncommand="openLinkText(event, 'donateURL');"/>
-          <menuitem id="feedbackPage"
-                    data-l10n-id="menu-help-share-feedback"
-                    oncommand="openLinkText(event, 'feedbackURL');"/>
           <menuseparator id="functionsSeparator"/>
           <menuitem id="helpTroubleshootMode"
                     data-l10n-id="menu-help-enter-troubleshoot-mode"
                     oncommand="safeModeRestart();"/>
           <menuitem id="aboutsupport_open"
                     data-l10n-id="menu-help-troubleshooting-info"
                     oncommand="openAboutSupport();"/>
 #ifndef XP_MACOSX
diff --git a/mail/base/content/utilityOverlay.js b/mail/base/content/utilityOverlay.js
--- a/mail/base/content/utilityOverlay.js
+++ b/mail/base/content/utilityOverlay.js
@@ -204,20 +204,17 @@ function openLinkText(event, what) {
   switch (what) {
     case "getInvolvedURL":
       openUILink("https://www.thunderbird.net/get-involved/", event);
       break;
     case "keyboardShortcutsURL":
       openUILink("https://support.mozilla.org/kb/keyboard-shortcuts/", event);
       break;
     case "donateURL":
-      openUILink(
-        "https://give.thunderbird.net/?utm_source=thunderbird-client&utm_medium=referral&utm_content=help-menu",
-        event
-      );
+      openUILink("https://www.betterbird.eu/donate/", event);
       break;
     case "tourURL":
       openUILink("https://www.thunderbird.net/features/", event);
       break;
     case "feedbackURL":
       openUILink("https://connect.mozilla.org/", event);
       break;
   }
diff --git a/mail/branding/betterbird/content/aboutDialog.css b/mail/branding/betterbird/content/aboutDialog.css
--- a/mail/branding/betterbird/content/aboutDialog.css
+++ b/mail/branding/betterbird/content/aboutDialog.css
@@ -7,22 +7,22 @@
 }
 
 #leftBox {
   background-image: url("chrome://branding/content/about-logo.svg");
   background-repeat: no-repeat;
   /* min-width and min-height create room for the logo */
   min-width: 210px;
   min-height: 210px;
-  margin-top: 20px;
   margin-inline-start: 30px;
 }
 
 #rightBox {
   background-size: 260px auto;
+  margin-top: 40px;
 }
 
 #updateDeck > hbox > label:not([class="text-link"]) {
   opacity: 0.6;
 }
 
 #trademark {
   font-size: xx-small;
diff --git a/mail/components/about-support/content/aboutSupport.js b/mail/components/about-support/content/aboutSupport.js
--- a/mail/components/about-support/content/aboutSupport.js
+++ b/mail/components/about-support/content/aboutSupport.js
@@ -115,16 +115,17 @@ function toFluentID(str) {
     .toLowerCase();
 }
 
 // Each property in this object corresponds to a property in Troubleshoot.jsm's
 // snapshot data.  Each function is passed its property's corresponding data,
 // and it's the function's job to update the page with it.
 var snapshotFormatters = {
   async application(data) {
+    // This comes form Services.appinfo.name likely via MOZ_APP_BASENAME.
     $("application-box").textContent = "Betterbird";
     $("useragent-box").textContent = data.userAgent;
     $("os-box").textContent = data.osVersion;
     if (data.osTheme) {
       $("os-theme-box").textContent = data.osTheme;
     } else {
       $("os-theme-row").hidden = true;
     }
diff --git a/mail/components/customizableui/content/panelUI.inc.xhtml b/mail/components/customizableui/content/panelUI.inc.xhtml
--- a/mail/components/customizableui/content/panelUI.inc.xhtml
+++ b/mail/components/customizableui/content/panelUI.inc.xhtml
@@ -543,42 +543,24 @@
       </vbox>
     </panelview>
 
     <!-- Help -->
     <panelview id="appMenu-helpView"
                data-l10n-id="appmenu-help-panel-title"
                class="PanelUI-subView">
       <vbox class="panel-subview-body">
-        <toolbarbutton id="appmenu_openHelp"
-                       class="subviewbutton subviewbutton-iconic"
-                       data-l10n-id="appmenu-help-get-help"
-                       key="key_openHelp"
-                       oncommand="openSupportURL();"/>
-        <toolbarbutton id="appmenu_openTour"
-                       class="subviewbutton subviewbutton-iconic"
-                       data-l10n-id="appmenu-help-explore-features"
-                       oncommand="openLinkText(event, 'tourURL');"/>
         <toolbarbutton id="appmenu_keyboardShortcuts"
                        class="subviewbutton subviewbutton-iconic"
                        data-l10n-id="appmenu-help-shortcuts"
                        oncommand="openLinkText(event, 'keyboardShortcutsURL');"/>
-        <toolbarseparator/>
-        <toolbarbutton id="appmenu_getInvolved"
-                       class="subviewbutton subviewbutton-iconic"
-                       data-l10n-id="appmenu-help-get-involved"
-                       oncommand="openLinkText(event, 'getInvolvedURL');"/>
         <toolbarbutton id="appmenu_makeDonation"
                        class="subviewbutton subviewbutton-iconic"
                        data-l10n-id="appmenu-help-donation"
                        oncommand="openLinkText(event, 'donateURL');"/>
-        <toolbarbutton id="appmenu_submitFeedback"
-                       class="subviewbutton subviewbutton-iconic"
-                       data-l10n-id="appmenu-help-share-feedback"
-                       oncommand="openLinkText(event, 'feedbackURL');"/>
         <toolbarseparator/>
         <toolbarbutton id="appmenu_troubleshootMode"
                        class="subviewbutton subviewbutton-iconic"
                        data-l10n-id="appmenu-help-enter-troubleshoot-mode2"
                        oncommand="safeModeRestart();"/>
         <toolbarbutton id="appmenu_troubleshootingInfo"
                        class="subviewbutton subviewbutton-iconic"
                        data-l10n-id="appmenu-help-troubleshooting-info"
diff --git a/mail/confvars.sh b/mail/confvars.sh
--- a/mail/confvars.sh
+++ b/mail/confvars.sh
@@ -1,13 +1,15 @@
 #! /bin/sh
 # This Source Code Form is subject to the terms of the Mozilla Public
 # License, v. 2.0. If a copy of the MPL was not distributed with this
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
+# We need to keep MOZ_APP_NAME thunderbird, otherwise all the code that checks
+# AppConstants.MOZ_APP_NAME won't work any more, and there is such code in M-C!
 MOZ_APP_NAME=thunderbird
 
 if test "$OS_ARCH" = "WINNT"; then
   if ! test "$HAVE_64BIT_BUILD"; then
     MOZ_VERIFY_MAR_SIGNATURE=1
   fi
 fi
 
diff --git a/mail/locales/en-US/messenger/aboutDialog.ftl b/mail/locales/en-US/messenger/aboutDialog.ftl
--- a/mail/locales/en-US/messenger/aboutDialog.ftl
+++ b/mail/locales/en-US/messenger/aboutDialog.ftl
@@ -60,15 +60,15 @@ aboutDialog-version = { $version } ({ $b
 aboutDialog-version-nightly = { $version } ({ $isodate }) ({ $bits }-bit)
 
 aboutdialog-update-checking-failed = Failed to check for updates.
 
 community-experimental = <a data-l10n-name="community-exp-mozilla-link">{ -vendor-short-name }</a> is a <a data-l10n-name="community-exp-credits-link">global community</a> working together to keep the Web open, public and accessible to all.
 
 community-desc = { -brand-short-name } is designed by <a data-l10n-name="community-mozilla-link">{ -vendor-short-name }</a>, a <a data-l10n-name="community-credits-link">global community</a> working together to keep the Web open, public and accessible to all.
 
-about-donation = Want to help? <a data-l10n-name="helpus-donate-link">Make a donation</a> or <a data-l10n-name="helpus-get-involved-link">get involved!</a>
+about-donation = Want to help? <a data-l10n-name="helpus-donate-link">Make a donation</a>!</a>
 
 bottom-links-license = Licensing Information
 bottom-links-rights = End-User Rights
 bottom-links-privacy = Privacy Policy
 cmd-close-mac-command-key =
     .key = w
diff --git a/mail/moz.configure b/mail/moz.configure
--- a/mail/moz.configure
+++ b/mail/moz.configure
@@ -2,16 +2,17 @@
 # vim: set filetype=python:
 # This Source Code Form is subject to the terms of the Mozilla Public
 # License, v. 2.0. If a copy of the MPL was not distributed with this
 # file, You can obtain one at http://mozilla.org/MPL/2.0/.
 
 set_config("MOZ_THUNDERBIRD", True)
 set_define("MOZ_THUNDERBIRD", True)
 
+# We can't set this to Betterbird or else Thunderbird profiles won't be recognised.
 imply_option("MOZ_APP_BASENAME", "Thunderbird")
 set_config("MOZ_APPUPDATE_HOST", "aus.thunderbird.net")
 
 imply_option("--enable-default-browser-agent", False)
 imply_option("MOZ_REQUIRE_SIGNING", False)
 imply_option("MOZ_SERVICES_SYNC", True)
 
 
