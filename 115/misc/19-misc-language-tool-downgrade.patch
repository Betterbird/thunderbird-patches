# HG changeset patch
# User Betterbird <betterbird@betterbird.eu>
# Parent  a77d22a3ac30c40f9f5928e01285f163925087bd
Misc: Don't allow stuff inserted by Language Tool to prevent plaintext downgrade.

diff --git a/mailnews/compose/src/nsMsgCompose.cpp b/mailnews/compose/src/nsMsgCompose.cpp
--- a/mailnews/compose/src/nsMsgCompose.cpp
+++ b/mailnews/compose/src/nsMsgCompose.cpp
@@ -4611,16 +4611,28 @@ void nsMsgCompose::TagConvertible(Elemen
 
   nsAutoString element;
   element = node->NodeName();
 
   // A style attribute on any element can change layout in any way,
   // so that is not convertible.
   nsAutoString attribValue;
   node->GetAttribute(u"style"_ns, attribValue);
+
+  // Skip stuff inserted by the add-on "Language Tool".
+  if (element.LowerCaseEqualsLiteral("lt-container")) {
+    *_retval = nsIMsgCompConvertible::Plain;
+    return;
+  }
+  if (element.LowerCaseEqualsLiteral("body") &&
+      attribValue.EqualsLiteral("padding-bottom: 1px;")) {
+    *_retval = nsIMsgCompConvertible::Plain;
+    return;
+  }
+
   if (!attribValue.IsEmpty()) {
     *_retval = nsIMsgCompConvertible::No;
     return;
   }
 
   // moz-* classes are used internally by the editor and mail composition
   // (like moz-cite-prefix or moz-signature). Those can be discarded.
   // But any other ones are unconvertible. Style can be attached to them or any
